---
title: "Setting_up_scraps"
author: "Christopher Loan"
date: "2023-02-15"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



---

class: center, middle

# The "pipe": `%>%`

---

# Understanding the Pipe

* A very useful feature of the `tidyverse` framework is the pipe
* The pipe takes an object and passes it along as the first argument of a function
* It's use with `dplyr` - a `tidyverse` package - is one of my favorite use cases.
* (examples coming shortly)

___

### Keyboard Shortcuts

mac: `command + shift + m`

PC: `control + shift + m`

---


# Using the pipe

We use the pipe to 

```{r eval = FALSE, include = TRUE, echo = TRUE}
function_name(first_argument = object_name, second_arg = TRUE, ...)
```



The object on the left of the pipe is given to the function on the right as the first argument.

Here are 3 equivalent ways to use the pipe.

```{r eval = FALSE, include = TRUE, echo = TRUE}
object_name %>% function_name(first_argument = ., second_arg = TRUE, ...)
# OR
object_name %>% function_name(second_arg = TRUE, ...)
```


---

# Example

if we want to see the first few rows of data, we can use `head()` with two arguments: 

* `x` = a data frame
* `n` = the number of rows to print

Let's do this with and without the pipe

```{r include=TRUE}
identical(
  head(x = dat, n = 3), 
  dat %>% head(x = ., n = 3)
)
```


---

# Why do we care about `dplyr` &  %>%?

* Gave a framework to review a few things about `R`
* Allows me to show pipes with less confusion
* In some later cases, it is *substantially* easier to read code with pipes

**Example: get the mean and standard deviation of `se_xpd_totl_gd_zs` for each year**

`se_xpd_totl_gd_zs` is the percent of the population between 15-64.

In `tidyverse` framework:

```{r inclued=TRUE, eval=FALSE}
dat %>% 
  group_by(year) %>% 
  summarize(
    means = mean(se_xpd_totl_gd_zs),
    sds = sd(se_xpd_totl_gd_zs)
    ) 
```

---

# Why do we care about `dplyr` &  %>%?

Example continued (in base)

```{r inclued=TRUE, eval=FALSE}
year_list <- split(dat, dat$year)
means <- 
  vapply(
    X = year_list, 
    FUN = function(x) mean(x$se_xpd_totl_gd_zs), 
    FUN.VALUE = double(1)
  ) 
sds <- vapply(
  X = year_list, 
  FUN = function(x) sd(x$se_xpd_totl_gd_zs),
  FUN.VALUE = double(1)
  ) 
data.frame(
  years = names(year_list),
  means = means,
  sds = sds
)
```

